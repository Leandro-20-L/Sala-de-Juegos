<div class="chat-container">
  <div class="messages" #messagesContainer *ngIf="mensajes$ | async as mensajes">
    <div 
      *ngFor="let msg of mensajes" 
      class="message"
      [ngClass]="msg.user_id === userId ? 'mine' : 'theirs'"
    >
      <div class="meta">
        <span class="email">{{ msg.email || 'Anon' }}</span>
        <br>
        <span class="time">{{ msg.creado_en | date:'shortTime' }}</span>
      </div>
      <div class="text">
        {{ msg.contenido }}
      </div>
    </div>
  </div>

  <form [formGroup]="chatForm" (ngSubmit)="enviar()" class="input-container">
    <input
      type="text"
      formControlName="mensaje"
      placeholder="Escribe un mensaje..."
    />
    <button type="submit" [disabled]="chatForm.invalid">Enviar</button>
  </form>

  <small *ngIf="chatForm.get('mensaje')?.hasError('required')" class="error">
    El mensaje no puede estar vacío
  </small>
  <small *ngIf="chatForm.get('mensaje')?.hasError('maxlength')" class="error">
    Máximo de 200 caracteres alcanzado
  </small>
</div>
